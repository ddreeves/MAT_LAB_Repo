# ğŸ“ Directory Structure
# malware-analysis-lab/
# â”œâ”€â”€ yara_rules/
# â”‚   â”œâ”€â”€ basic_malware.yar
# â”‚   â””â”€â”€ ransomware.yar
# â”œâ”€â”€ sigma_rules/
# â”‚   â”œâ”€â”€ suspicious_process_creation.yml
# â”‚   â””â”€â”€ encoded_powershell.yml
# â”œâ”€â”€ setup/
# â”‚   â”œâ”€â”€ install_remnux.sh
# â”‚   â”œâ”€â”€ install_proxmox_config.md
# â”‚   â””â”€â”€ cuckoo_installation_guide.md
# â”œâ”€â”€ samples/
# â”‚   â”œâ”€â”€ README.md
# â””â”€â”€ README.md

# ğŸ“„ yara_rules/basic_malware.yar
rule Basic_Malware_Example {
    meta:
        description = "Detects executable with MZ header and common strings"
        author = "Your Name"
    strings:
        $mz = {4D 5A}
        $str1 = "malware" ascii nocase
        $str2 = "ransom" ascii nocase
    condition:
        $mz at 0 and any of ($str*)
}

# ğŸ“„ yara_rules/ransomware.yar
rule Ransomware_Generic_Encryptor {
    meta:
        description = "Detects generic ransomware encryption behavior"
        author = "Your Name"
    strings:
        $ext1 = ".locked"
        $ext2 = ".encrypted"
        $str1 = "Your files have been encrypted" ascii
    condition:
        any of ($ext*) or $str1
}

# ğŸ“„ sigma_rules/suspicious_process_creation.yml
detection:
  selection:
    EventID: 4688
    NewProcessName|contains:
      - "powershell"
      - "cmd.exe"
      - "wscript.exe"
  condition: selection
fields:
  - CommandLine
  - ParentProcessName
logsource:
  product: windows
  service: security

# ğŸ“„ sigma_rules/encoded_powershell.yml
detection:
  selection:
    CommandLine|contains:
      - "-enc"
      - "powershell"
  condition: selection
fields:
  - CommandLine
  - Image
logsource:
  product: windows
  service: sysmon
